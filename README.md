# cnm-code

Graph sampling algorithms from the paper 'Constraints and spandrels of interareal connectomes'.
Rubinov (2016) Nature Communications 7 13812, doi:10.1038/ncomms13812.

|                             | SIMANN_CONSTRAINT_MODEL: constrained randomization of empirical networks                                                                                  | MLEME_CONSTRAINT_MODEL: exact maximum-likelihood estimation of maximum-entropy/exponential random-graph models                                                                                      |
|-----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Type of sampling            | Uniform sampling of networks with hard constraints: the constraints are satisfied with high accuracy for each individual sampled network.                 | Unbiased sampling of networks with soft constraints: the constraints are satisfied on average for the network ensemble, but not, in general, for each individual network.                       |
| Method of sampling          | Specification of constraint-error function, and sampling of individual networks via numerical minimization (with simulated annealing) of this function.   | Maximum-likelihood estimation of network probability distribution by numerical solution of systems of nonlinear equations, and sampling of individual networks directly from this distribution. |
| Type of studied constraints | Weighted and binary node-strength, module-weight, and wiring-cost constraints. In addition, all empirical connection weights are automatically preserved. | Weighted node-strength and module-weight constraints. Empirical connection weights are not preserved.                                                                                           |
| Accuracy                    | A small normalized constraint error (<0.005), similar for all network models.                                                                             | Constraint errors are guaranteed to vanish in the limit of the full network ensemble. The studied 1,000-network ensembles had constraint errors similar in magnitude to the primary method.     |
| Disadvantages               | Uniform sampling is possible but not formally guaranteed.                                                                                                 | Sampled distributions may not be representative of target distributions.                                                                                                                        |
| Implementation              | MEX file called from a MATLAB wrapper (the mex file needs to be compiled once before execution).                                                          | Native MATLAB implementation (requires the optimization toolbox).                                                                                                                               |